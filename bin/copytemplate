#!/usr/bin/env bash

SCRIPT_DIR=$(dirname $0)

set -e
source "${SCRIPT_DIR}/core.incl.sh"

function copytemplate () {
    local servie=$1
    local file=$2
    shift 2

    local war_dir=$(war_template_dir ${servie})
    local file_dir=$(dirname ${file})

    if [ "$file_dir" != "." ]; then
        mkdir -p ${file_dir}
    else
        file_dir=""
    fi

    mkdir -p base/${servie}/custom/pages

    local cpsource=${war_dir}/${file}
    local cptarget=base/${servie}/custom/pages/${file_dir}

    local srctarget=src/${servie}/custom/pages/${file_dir}

    echo -e "Copying file:"
    echo -e "\tfrom: ${cpsource}"
    echo -e "\tto: ${cptarget}/${file}"

    cp $@ ${cpsource} ${cptarget}

    if [ ! -f ${srctarget} ]; then
        echo -e "\tsrc: ${srctarget}/${file}"
        cp $@ ${cpsource} ${srctarget}
    fi

    echo -e "File copied!"
}

copytemplate $@
